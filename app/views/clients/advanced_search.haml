.row
  .col-xs-12
    .ibox
      .ibox-title
        %h5= t('.advanced_search')
      .ibox-content
        .row
          .col-xs-12
            #builder{ 'data-field-list' => @advanced_filter_fields, 'data-search-rules' => @advanced_filter_params, 'data-filter-translation' => t('.add_new_filter')}
      .ibox-footer
        %button#search.btn.btn-primary= t('.search')
        = link_to t('.reset'), advanced_search_clients_path, class: 'btn btn-default'
.row
  .col-xs-12
    .ibox
      - if @clients_filtered.present?
        .ibox-title
          %h5= @clients_by_user.size
          %span.label.label-info= t('.results')
        .ibox-content
          .client-advanced-search.table-responsive
            %table.table.table-bordered.table-striped.table-hover.clients.dataTable.no-footer
              %thead
                %tr
                  %th.id-column ID
                  %th Name
                  - @clients_filtered.first.attributes.keys.each do |column_name|
                    - next if column_name == 'slug' || column_name == 'first_name' || column_name == 'id'
                    %th
                      = column_name == 'date_of_birth' ? 'Age' : column_name.titleize
              %tbody
                - @clients_filtered.each do |client|
                  %tr
                    %td.id-column= client.slug
                    %td= link_to client.first_name, client_path(client) 
                    - client.attributes.each do |field_name, value|
                      - next if field_name == 'slug' || field_name == 'first_name' || field_name == 'id'
                      %td
                        = format_advance_search_result(field_name, (field_name == 'date_of_birth' ? client : value))
        .ibox-footer.text-center
          = paginate @clients_filtered
      - else
        .ibox-content
          = t('.no_results')
= simple_form_for :client, url: :advanced_search_clients, method: 'GET', html: { id: 'advanced-search' } do |f|
  = f.hidden_field :search_rules
