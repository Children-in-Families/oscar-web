= simple_form_for [@client, @government_form] do |f|
  .ibox-content
    = f.input :name, as: :hidden
    = hidden_field_tag :form_num, params[:form]
    = error_notification(f)
    .row
      .col-xs-12
        %h2.text-center= 'ទម្រង់ទី២: ការប៉ាន់ប្រមាណករណី និងគញរួសារ'
      = render 'government_info', f: f
      .col-xs-12
        %hr
        %h3= 'ទីកន្លែងប៉ាន់ប្រមាណ៖'
      .col-xs-12.col-sm-4
        = f.association :province, collection: @provinces, label: 'រាជធានី/ខេត្ត', input_html: { data: { type: 'provinces', 'subaddress' => 'district' } }
      .col-xs-12.col-sm-4
        = f.association :district, collection: @districts, label: 'ក្រុង/ស្រុក/ខណ្ឌ', input_html: { data: { type: 'districts' } }
      .col-xs-12.col-sm-4
        = f.association :commune, collection: @communes.map{|c| [c.name, c.id] }, label: 'ឃុំ/សង្កាត់', input_html: { data: { type: 'communes' } }
      .col-xs-12
        %hr
      .col-xs-12.col-sm-4.clearfix
        = f.input :case_worker_id, as: :select, collection: @users.map{|user| [user.name, user.id, selected: current_user.id == user.id] }, label: 'ឈ្មោះអ្នកកាន់ករណី'
      .col-xs-12.col-sm-4
        = f.input :case_worker_phone, input_html: { value:  ''}, label: 'លេខទូរសព្ទ'
      .col-xs-12
        %hr
        %h3= 'ស្ថានភាពកុមារ និង តម្រូវការ'
      .col-xs-12.col-sm-12
        = f.simple_fields_for :government_form_children_plans do |f_children_status|
          = render 'children_status_fields', f: f_children_status
      .col-xs-12
        %hr
        %h3= 'ផែនការសំរាប់គ្រួសារ'
      .col-xs-12
        = f.simple_fields_for :government_form_family_plans do |f_family_status|
          = render 'family_status_fields', f: f_family_status
      .col-xs-12
        %hr
        %h3= 'ស្ថានភាពគ្រួសារ'
      .col-xs-12

      .col-xs-12
        %hr
        %h3= 'សេចក្តីសន្និដ្ឋាន របស់អ្នកកាន់ករណី'
      .col-xs-12
        .i-checks
          = f.input :caseworker_assumption, as: :radio_buttons, collection: GovernmentForm::CASEWORKER_ASSUMPTIONS, wrapper_html: { class: 'row' }, item_wrapper_class: 'col-xs-12 col-sm-3', label: false
        = f.input :assumption_description, label: false, input_html: { rows: '10' }
      .col-xs-12
        .row
          .col-xs-12.col-sm-6.col-md-4.form-group.date.optional.government_form_assumption_date{ class: ('has-error' if f.error :date) }
            %label.date.optional.control-label{ for: 'government_form_assumption_date' }
              = 'កាលបរិច្ឆេទ'
            .input-group.date
              = f.text_field :date, class: 'date optional form-control date-picker', type: 'text', name: 'government_form[assumption_date]', id: 'government_form_assumption_date'
              %span.input-group-addon.initial-referral
                %i.fa.fa-calendar-check-o
            = f.error :date
        .row
          .col-xs-12.col-sm-6.col-md-4
            = f.input :case_worker_id, as: :select, collection: @users.map{|user| [user.name, user.id, selected: current_user.id == user.id] }, label: 'ឈ្មោះអ្នកកាន់ករណី'
      .col-xs-12
        %hr
        %h3= 'កិច្ចពិភាក្សាអំពីសេវា'
      .col-xs-12
        = f.label :contact_type, 'ប្រភេទទំនាក់ទំនង'
        .i-checks
          = f.input :contact_type, as: :radio_buttons, collection: GovernmentForm::CONTACT_TYPES, wrapper_html: { class: 'row' }, item_wrapper_class: 'col-xs-12 col-sm-3', label: false
      .col-xs-12
        %hr
        %h3= 'ប្រភេទសេវា'
      .col-xs-12
        = f.association :service_types, collection: @service_types, as: :check_boxes, input_html: { class: 'i-checks' }, wrapper_html: { class: 'row' }, item_wrapper_class: 'col-xs-12 col-sm-4', label: false
        = f.input :other_service_type, label: false, input_html: { placeholder: 'Ohter' }, as: :hidden
      .col-xs-12
        %hr
        %h3= 'ការពន្យល់អំពីសិទ្ធិរបស់អតិថិជន'
      .col-xs-12
        = f.association :client_rights, collection: @client_rights, as: :check_boxes, input_html: { class: 'i-checks' }, label: false

      .col-xs-12
        %hr
        %h3= 'ការសម្រេចចិត្តរបស់អតិថិជន'
      .col-xs-12
        .i-checks
          = f.input :client_decision, as: :radio_buttons, collection: GovernmentForm::CLIENT_DECISIONS, wrapper_html: { class: 'row' }, item_wrapper_class: 'col-xs-12 col-sm-3', label: false

  .ibox-footer
    = f.submit t('save'), class: 'btn btn-primary form-btn'
    = link_to t('cancel'), client_government_forms_path(form: params[:form]), class: 'btn btn-default form-btn'
