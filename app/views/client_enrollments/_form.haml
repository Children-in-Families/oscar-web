= simple_form_for ([@client, @client_enrollment]) do |f|
  .ibox-content
    .row
      .col-xs-12.col-sm-6.col-md-4.form-group.date.optional.client_date_of_birth{ class: ('has-error' if f.error :enrollment_date) }
        %label.date.optional.control-label
          %abbr{ title: 'required' } *
          = t('.enrollment_date')
        #client-birthdate.input-group.date
          = f.text_field :enrollment_date, class: 'date optional form-control date-picker', type: 'text', id: 'enrollment_date'
          %span.input-group-addon
            %i.fa.fa-calendar-check-o
        %span.help-block.hidden= t('cannot_be_blank')
    = f.simple_fields_for :properties, OpenStruct.new(@client_enrollment.properties) do |prop_f|
      - @program_stream.enrollment.each_slice(2) do |n_field|
        .row
          - n_field.each do |enrollment|
            .col-xs-12.col-md-6
              = render "/shared/fields/#{enrollment['type'].underscore}", f: prop_f, field_props: enrollment, errors: @client_enrollment.errors.messages
        .row
          .col-xs-12
            #message.text-danger
  .ibox-footer
    = hidden_field_tag :program_stream_id, @program_stream.id
    = hidden_field_tag :program_streams, params[:program_streams]
    = f.submit t('.save'), class: 'btn btn-primary form-btn'
    - if params[:action] == 'new' || params[:action] == 'create'
      = link_to t('.cancel'), client_client_enrollments_path(@client, program_streams: 'program-streams'), class: 'btn btn-default form-btn'
    - elsif params[:action] == 'edit' || params[:action] == 'update'
      = link_to t('.cancel'), client_client_enrollment_path(@client, @client_enrollment, program_stream_id: params[:program_stream_id]), class: 'btn btn-default form-btn'
